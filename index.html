<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="favicon.png" />

    <title>Trimify – Online Audio Editor & Trimmer</title>
    <meta
      name="description"
      content="Trimify is a fast, privacy-first audio editor and trimmer that works entirely in your browser. No uploads, no tracking. Trim and merge audio easily."
    />
    <meta
      name="keywords"
      content="audio editor, audio trimmer, combine audio, browser audio editing, online audio tool, trim mp3, merge mp3, privacy audio editor"
    />
    <meta name="author" content="Keshu" />
    <meta name="robots" content="index, follow" />

    <!-- Social Sharing -->
    <meta property="og:title" content="Trimify – Online Audio Editor" />
    <meta
      property="og:description"
      content="Trimify lets you trim and merge audio in your browser with no upload. Fast. Free. Private."
    />
    <meta
      property="og:image"
      content="https://yourusername.github.io/trimify/preview.jpg"
    />
    <meta property="og:url" content="https://yourusername.github.io/trimify/" />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- Mobile Browser Color -->
    <meta name="theme-color" content="#0a0f1e" />

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Trimify</title>
    <style>
      /* Reset and Base */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        outline: none;
        border: none;
      }
      html,
      body {
        height: 100%;
        width: 100%;
        overflow-x: hidden;
        scroll-behavior: smooth;
        background: radial-gradient(circle at center, #0f172a, #020617 60%),
          linear-gradient(to bottom, rgba(2, 6, 23, 0) 60%, #0a0f1e 100%);
        background-blend-mode: overlay;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica,
          Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
          "Segoe UI Symbol";
        color: #c9d1d9;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      #floating-notes {
        pointer-events: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        overflow: visible;
        z-index: 5;
        transform: translateZ(0);
        backface-visibility: hidden;
      }

      .note {
        position: absolute;
        font-size: 16px;
        color: #58a6ff;
        opacity: 0.6;
        user-select: none;
        transition: transform 0.3s ease;
        will-change: transform;
        backface-visibility: hidden;
      }

      /* Main Panel */
      .panel {
        position: relative;
        z-index: 10;
        width: 580px;
        background: rgba(11, 12, 16, 0.9);
        backdrop-filter: saturate(180%) blur(20px);
        border-radius: 1.5rem;
        padding: 2.5rem 3rem;
        margin-top: 3rem;
        margin-bottom: 8rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.8), 0 0 1px rgba(0, 0, 0, 0.5);
        text-align: center;
        animation: fadeScaleIn 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        opacity: 0;
        transform: translateY(15px) scale(0.98);
      }

      .title {
        font-size: 3rem;
        font-weight: 700;
        background: linear-gradient(-45deg, #58a6ff, #f9d423, #6a11cb, #58a6ff);
        background-size: 300% 300%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: animatedGradient 6s ease infinite;
      }

      .intro-text {
        font-size: 1.1rem;
        font-weight: 500;
        color: #8b949e;
        line-height: 1.5;
        margin-bottom: 1rem;
        max-width: 500px;
      }

      .description {
        font-size: 1.15rem;
        font-weight: 600;
        opacity: 0.8;
        color: #8b949e;
        line-height: 1.4;
      }

      .description-sub {
        font-size: 1rem;
        opacity: 0.65;
        color: #6e7681;
        line-height: 1.5;
      }

      .options {
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 2rem;
        flex-wrap: wrap;
      }

      .options button {
        flex: 1;
        max-width: 200px;
        padding: 0.75rem 1.5rem;
        font-size: 1.15rem;
        border-radius: 12px;
        cursor: pointer;
        background: #238636;
        color: white;
        font-weight: 600;
        box-shadow: 0 1px 0 rgb(27 31 35 / 20%);
        transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),
          box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.1s ease-out;
      }

      .options button:hover,
      .options button:focus {
        background-color: #2ea043;
        box-shadow: 0 8px 24px rgba(46, 160, 67, 0.4), 0 0 0 0 rgba(0, 0, 0, 0);
        transform: scale(1.05);
        outline-offset: 2px;
      }

      .options button:active {
        background-color: #238636;
        box-shadow: none;
        transform: scale(0.95);
      }

      /* File input */
      #audioInput {
        display: none;
      }

      /* Trim Menu */
      #trimMenu {
        display: none;
        width: 100%;
        background: #161b22;
        border-radius: 12px;
        padding: 1.5rem 2rem;
        box-shadow: 0 12px 24px rgb(20 23 28 / 0.6);
        margin-top: 1.5rem;
        text-align: left;
        color: #cdd9e5;
        user-select: none;
      }

      #trimMenu.visible {
        display: block;
        animation: fadeInSlideDown 0.3s ease forwards;
      }

      @keyframes fadeInSlideDown {
        from {
          opacity: 0;
          transform: translateY(-8px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      #trimMenu h3 {
        margin-bottom: 1rem;
        font-weight: 600;
        font-size: 1.25rem;
        color: #58a6ff;
      }

      .audio-player {
        width: 100%;
        margin-bottom: 1rem;
      }

      .slider-container {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      .slider-container label {
        white-space: nowrap;
        min-width: 60px;
        font-weight: 600;
        font-size: 0.9rem;
        color: #8b949e;
      }

      .slider-container input[type="range"] {
        flex: 1;
        -webkit-appearance: none;
        height: 8px;
        border-radius: 6px;
        background: #30363d;
        cursor: pointer;
        transition: background 0.15s ease-in-out;
      }

      .slider-container input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #58a6ff;
        cursor: pointer;
        box-shadow: 0 0 8px 2px #58a6ff77;
        transition: background 0.15s ease-in-out;
      }

      .slider-container input[type="range"]:focus::-webkit-slider-thumb {
        background: #1f6feb;
        box-shadow: 0 0 12px 3px #1f6febaa;
      }

      .slider-values {
        font-family: monospace;
        font-size: 0.85rem;
        min-width: 50px;
        color: #8b949e;
        text-align: right;
      }

      #trimActions {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
      }

      #trimActions button {
        padding: 0.6rem 1.2rem;
        border-radius: 8px;
        background-color: #238636;
        color: white;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 1px 0 rgb(27 31 35 / 20%);
        transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),
          box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.1s ease-out;
      }

      #trimActions button:hover,
      #trimActions button:focus {
        background-color: #2ea043;
        box-shadow: 0 8px 26px rgba(46, 160, 67, 0.4);
        transform: scale(1.05);
        outline-offset: 2px;
      }

      #trimActions button:active {
        background-color: #238636;
        box-shadow: none;
        transform: scale(0.95);
      }

      /* Scroll Indicator */
      .scroll-indicator {
        text-align: center;
        margin-top: -75px; /* Move the entire section 20px upwards */
        margin-bottom: 0.5rem; /* Adjust bottom margin as needed */
        cursor: pointer;
        opacity: 0.8;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        user-select: none;
        display: flex;
        flex-direction: column;
        align-items: center;
        font-weight: 600;
        font-size: 1.1rem;
        color: #58a6ff;
        gap: 0.25rem;
        z-index: 15;
        padding-bottom: 0.5rem; /* Added padding bottom */
      }

      .scroll-indicator:hover {
        opacity: 1;
      }

      .arrow {
        font-size: 2rem;
        color: #58a6ff;
        animation: bounce 2s infinite;
        margin-top: -0.5rem; /* Moved arrow slightly up */
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(8px);
        }
      }

      /* Cards Section */
      .cards-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 2rem;
        padding: 5rem 2rem 8rem;
        width: 100%;
        max-width: 1200px;
      }

      .card {
        background: #121212;
        color: #c9d1d9;
        border: 1px solid #30363d;
        border-radius: 12px;
        padding: 2rem;
        width: 300px;
        box-shadow: 0 2px 6px rgb(0 0 0 / 0.2);
        transition: transform 0.25s cubic-bezier(0.645, 0.045, 0.355, 1),
          box-shadow 0.25s cubic-bezier(0.645, 0.045, 0.355, 1),
          opacity 0.5s ease;
        opacity: 0;
        transform: translateY(20px);
      }

      .card.visible {
        opacity: 1;
        transform: translateY(0);
      }

      .card:hover {
        transform: translateY(-8px) scale(1.03);
        box-shadow: 0 8px 32px rgb(21 156 228 / 0.3);
        border-color: #58a6ff;
      }

      .card h2 {
        font-size: 1.5rem;
        margin-bottom: 0.75rem;
        font-weight: 600;
        color: #58a6ff;
      }

      .card p {
        font-size: 1rem;
        opacity: 0.85;
        line-height: 1.5;
        color: #8b949e;
      }

      /* Download button - similar but distinct from other buttons */
      .download-button {
        padding: 0.6rem 1.4rem;
        border-radius: 12px;
        background-color: transparent;
        color: #2ea043;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        border: 2px solid #2ea043;
        box-shadow: none;
        transition: background-color 0.25s ease, color 0.25s ease,
          box-shadow 0.25s ease, transform 0.15s ease;
        user-select: none;
        display: inline-block;
      }

      .download-button:disabled {
        color: #6e7681;
        border-color: #444c56;
        cursor: not-allowed;
      }

      .download-button:not(:disabled):hover,
      .download-button:not(:disabled):focus {
        background-color: #2ea043;
        color: white;
        box-shadow: 0 8px 24px rgba(46, 160, 67, 0.5);
        transform: scale(1.05);
        outline-offset: 3px;
      }

      .download-button:not(:disabled):active {
        background-color: #238636;
        box-shadow: none;
        transform: scale(0.95);
      }

      /* Animations */
      @keyframes fadeScaleIn {
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      /* Responsive */
      @media (max-width: 768px) {
        .panel {
          width: 90%;
          padding: 2rem;
          margin-top: 8rem;
          margin-bottom: 6rem; /* Reduced to maintain spacing */
        }
        .options {
          flex-direction: column;
          gap: 1rem;
        }
        .card {
          width: 100%;
        }
        .scroll-indicator {
          margin: 2rem 0;
        }
      }

      /* Combine Audio Styles */
      #combineMenu {
        display: none;
        width: 100%;
        background: #161b22;
        border-radius: 12px;
        padding: 1.5rem 2rem;
        box-shadow: 0 12px 24px rgb(20 23 28 / 0.6);
        margin-top: 1.5rem;
        text-align: left;
        color: #cdd9e5;
        user-select: none;
        overflow-y: auto;
        max-height: 420px;
      }

      #combineMenu.visible {
        display: block;
        animation: fadeInSlideDown 0.3s ease forwards;
      }

      #combineMenu h3 {
        margin-bottom: 1rem;
        font-weight: 600;
        font-size: 1.25rem;
        color: #58a6ff;
      }

      #addAudioButton {
        background-color: #238636;
        color: white;
        border-radius: 12px;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
        font-size: 1.1rem;
        cursor: pointer;
        user-select: none;
        box-shadow: 0 1px 0 rgb(27 31 35 / 20%);
        transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),
          box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.1s ease-out;
        margin-bottom: 1rem;
      }

      #addAudioButton:hover,
      #addAudioButton:focus {
        background-color: #2ea043;
        box-shadow: 0 8px 24px rgba(46, 160, 67, 0.4);
        transform: scale(1.05);
        outline-offset: 2px;
      }

      #addAudioButton:active {
        background-color: #238636;
        box-shadow: none;
        transform: scale(0.95);
      }

      #audioList {
        margin-bottom: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        max-height: 220px;
        overflow-y: auto;
        border: 1px solid #30363d;
        border-radius: 12px;
        padding: 0.5rem;
        background-color: #0a0f1e;
      }

      .audioItem {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.4rem 0.6rem;
        border: 1px solid #30363d;
        border-radius: 8px;
        background-color: #121212;
        color: #c9d1d9;
        cursor: grab;
        user-select: none;
      }

      .audioItem.dragging {
        opacity: 0.7;
        background-color: #1b2738;
      }

      .audioItem span {
        flex: 1;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        margin-right: 8px;
      }

      .removeBtn {
        background: #bb2222;
        border-radius: 6px;
        padding: 0.2rem 0.5rem;
        color: white;
        font-weight: 600;
        cursor: pointer;
        user-select: none;
        border: none;
        transition: background-color 0.2s ease;
      }

      .removeBtn:hover,
      .removeBtn:focus {
        background: #cc3333;
        outline-offset: 0;
      }

      #combineButton {
        background-color: #238636;
        color: white;
        border-radius: 12px;
        padding: 0.8rem 1.8rem;
        font-weight: 600;
        font-size: 1.15rem;
        cursor: pointer;
        user-select: none;
        box-shadow: 0 1px 0 rgb(27 31 35 / 20%);
        transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),
          box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.1s ease-out;
        margin-bottom: 1rem;
        border: none;
        width: 100%;
      }

      #combineButton:disabled {
        background-color: #444c56;
        cursor: not-allowed;
        box-shadow: none;
      }

      #combineButton:not(:disabled):hover,
      #combineButton:not(:disabled):focus {
        background-color: #2ea043;
        box-shadow: 0 8px 24px rgba(46, 160, 67, 0.4);
        transform: scale(1.05);
        outline-offset: 2px;
      }

      #combineButton:not(:disabled):active {
        background-color: #238636;
        box-shadow: none;
        transform: scale(0.95);
      }

      /* Footer note */
      .footer-note {
        margin-top: 1rem;
        font-size: 0.85rem;
        opacity: 0.6;
        color: #6e7681;
        font-style: italic;
        max-width: 540px;
        user-select: none;
      }

      @keyframes animatedGradient {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      /* Global Page Loader */
      #loader-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #0a0f1e;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        transition: opacity 0.5s ease, visibility 0.5s ease;
      }

      #loader-overlay.fade-out {
        opacity: 0;
        visibility: hidden;
      }

      .loader-spinner {
        width: 48px;
        height: 48px;
        border: 4px solid rgba(255, 255, 255, 0.2);
        border-top-color: #58a6ff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Local Panel Loader */
      .loader-overlay-local {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
        z-index: 10;
      }
    </style>
  </head>
  <body>
    <!-- Global Loading Overlay -->
    <div id="loader-overlay">
      <div class="loader-spinner"></div>
    </div>

    <div id="floating-notes" aria-hidden="true"></div>

    <!-- Main Box -->
    <div class="panel" role="main" aria-label="Audio editing options">
      <h1 class="title">Trimify</h1>
      <p class="intro-text">
        Edit audio in seconds with Trimify — the fast, privacy-first tool built
        for modern creators. Trim, combine, and preview — all in your browser.
      </p>
      <p class="description" id="descriptionText">
        Choose an option below to start editing your audio effortlessly.
      </p>
      <p class="description-sub">
        Trim your favorite tracks or combine multiple audio files with ease.<br />
        Fast, simple, and entirely in your browser — no downloads needed.
      </p>
      <div class="options">
        <button id="trimAudioButton" aria-describedby="descriptionText">
          Start Trimming
        </button>
        <button id="combineAudioButton" aria-describedby="descriptionText">
          Merge Tracks
        </button>
      </div>
      <input
        type="file"
        id="audioInput"
        accept="audio/*"
        aria-label="Select audio file to trim"
        multiple
      />

      <!-- Trim Menu -->
      <div
        id="trimMenu"
        aria-live="polite"
        aria-atomic="true"
        aria-relevant="additions removals"
      >
        <h3>Trim Audio</h3>
        <audio
          controls
          class="audio-player"
          id="audioPlayer"
          preload="metadata"
        ></audio>

        <div class="slider-container">
          <label for="startRange">Start (s):</label>
          <input type="range" id="startRange" min="0" step="0.01" value="0" />
          <div class="slider-values" id="startTimeLabel">0.00</div>
        </div>

        <div class="slider-container">
          <label for="endRange">End (s):</label>
          <input type="range" id="endRange" min="0" step="0.01" value="0" />
          <div class="slider-values" id="endTimeLabel">0.00</div>
        </div>

        <div id="trimActions">
          <button id="trimButton" disabled>Trim and Play</button>
          <button id="resetButton">Reset</button>
        </div>

        <div id="trimmedAudioContainer" style="margin-top: 1rem">
          <h4
            id="trimmedAudioTitle"
            style="display: none; margin-bottom: 0.5rem; color: #58a6ff"
          >
            Trimmed Audio:
          </h4>
          <audio
            controls
            id="trimmedAudio"
            style="width: 100%; display: none"
          ></audio>
          <button
            id="downloadButton"
            class="download-button"
            disabled
            aria-label="Download trimmed audio"
            style="display: none; margin-top: 0.5rem"
          >
            Download Trimmed Audio
          </button>
        </div>
      </div>

      <!-- Combine Audio Menu -->
      <div
        id="combineMenu"
        aria-live="polite"
        aria-atomic="true"
        aria-relevant="additions removals"
        style="display: none; margin-top: 1.5rem; user-select: none"
      >
        <h3>Combine Audio</h3>
        <p
          style="
            color: #8b949e;
            margin-bottom: 0.8rem;
            font-style: italic;
            font-size: 0.95rem;
          "
        >
          You can add multiple audio files below. Drag and drop the files to
          reorder them in the sequence you want them combined.
        </p>
        <button
          id="addAudioButton"
          type="button"
          aria-label="Add audio files to combine"
        >
          Add Audio Files
        </button>
        <div
          id="audioList"
          aria-live="polite"
          aria-atomic="true"
          style="margin-top: 1rem"
        ></div>
        <button
          id="combineButton"
          type="button"
          disabled
          style="margin-top: 1rem; width: 100%"
        >
          Combine and Preview
        </button>
        <audio
          controls
          id="combinedAudio"
          style="display: none; width: 100%; margin-top: 1rem"
        ></audio>
        <button
          id="downloadCombinedButton"
          class="download-button"
          type="button"
          disabled
          style="display: none; margin-top: 0.5rem"
        >
          Download Combined Audio
        </button>
      </div>

      <p
        class="footer-note"
        aria-live="polite"
        aria-atomic="true"
        aria-relevant="text"
      >
        Your audio files never leave your device — we prioritize your privacy
        and security.
      </p>
    </div>

    <!-- Scroll Indicator -->
    <div
      class="scroll-indicator"
      id="scrollIndicator"
      role="button"
      tabindex="0"
      aria-label="Scroll for more info"
    >
      <p>Scroll for more info</p>
      <div class="arrow" aria-hidden="true">↓</div>
    </div>

    <!-- Scrollable Section -->
    <section
      class="cards-container"
      id="cardsSection"
      aria-label="Information about Trimify"
    >
      <div class="card" style="transition-delay: 0.1s" tabindex="0">
        <h2>About Trimify</h2>
        <p>
          Trimify is your personal audio editor, built for speed and simplicity.
          No app install required.
        </p>
      </div>
      <div class="card" style="transition-delay: 0.25s" tabindex="0">
        <h2>Features</h2>
        <p>
          Trim, merge, and preview your videos quickly and easily — all directly
          in your browser. Trimify is privacy-focused, so no files ever leave
          your device.
        </p>
      </div>
      <div class="card" style="transition-delay: 0.4s" tabindex="0">
        <h2>About Developer</h2>
        <p>
          Built with ❤️ by Keshu — a developer who values clean design,
          privacy-first tools, and smooth performance. Trimify is crafted to
          make audio editing fast and effortless, right in your browser.
        </p>
      </div>
    </section>

    <!-- Music Notes Script and main all JS -->
    <script>
      // The same JS code as provided earlier for notes, trim audio, combine audio...
      const notesContainer = document.getElementById("floating-notes");
      const noteSymbols = ["♪", "♫", "♬", "♩"];
      const notesCount = 30;
      const notes = [];

      for (let i = 0; i < notesCount; i++) {
        const note = document.createElement("div");
        note.classList.add("note");
        note.textContent =
          noteSymbols[Math.floor(Math.random() * noteSymbols.length)];
        note.style.left = Math.random() * window.innerWidth + "px";
        note.style.top = Math.random() * window.innerHeight + "px";
        note.speedX = (Math.random() - 0.5) * 0.3;
        note.speedY = (Math.random() - 0.5) * 0.3;
        notesContainer.appendChild(note);
        notes.push(note);
      }

      function animateNotes() {
        notes.forEach((note) => {
          let x = parseFloat(note.style.left);
          let y = parseFloat(note.style.top);
          x += note.speedX;
          y += note.speedY;
          if (x > window.innerWidth) x = 0;
          if (x < 0) x = window.innerWidth;
          if (y > window.innerHeight) y = 0;
          if (y < 0) y = window.innerHeight;
          note.style.left = x + "px";
          note.style.top = y + "px";
        });
        requestAnimationFrame(animateNotes);
      }
      animateNotes();

      function handleInteraction(clientX, clientY) {
        notes.forEach((note) => {
          let x = parseFloat(note.style.left);
          let y = parseFloat(note.style.top);
          const dx = clientX - x;
          const dy = clientY - y;
          const dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < 150) {
            const angle = Math.atan2(dy, dx);
            note.speedX = -Math.cos(angle) * 1.5;
            note.speedY = -Math.sin(angle) * 1.5;
            note.style.opacity = Math.min(1, 0.6 + (150 - dist) / 150);
            note.style.fontSize = Math.min(24, 16 + (150 - dist) / 10) + "px";
          } else {
            note.speedX *= 0.95;
            note.speedY *= 0.95;
            note.style.opacity = 0.6;
            note.style.fontSize = "16px";
          }
        });
      }

      window.addEventListener("mousemove", (e) =>
        handleInteraction(e.clientX, e.clientY)
      );
      window.addEventListener(
        "touchmove",
        (e) => {
          if (e.touches.length > 0) {
            handleInteraction(e.touches[0].clientX, e.touches[0].clientY);
          }
        },
        { passive: true }
      );

      // Scroll indicator scroll and hide logic
      const scrollIndicator = document.getElementById("scrollIndicator");
      const cardsSection = document.getElementById("cardsSection");

      function checkScroll() {
        if (window.scrollY > 50) {
          scrollIndicator.style.opacity = "0";
          scrollIndicator.style.pointerEvents = "none";
        } else {
          scrollIndicator.style.opacity = "0.8";
          scrollIndicator.style.pointerEvents = "auto";
        }
      }
      window.addEventListener("scroll", checkScroll);

      // Smooth scroll to cards on click on scroll indicator with custom easing
      function scrollToCards() {
        cardsSection.scrollIntoView({ behavior: "smooth" });
      }
      scrollIndicator.addEventListener("click", scrollToCards);
      scrollIndicator.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " " || e.key === "Spacebar") {
          e.preventDefault();
          scrollToCards();
        }
      });

      // Intersection Observer for card animation on scroll
      const cards = document.querySelectorAll(".card");

      const observerOptions = {
        root: null,
        rootMargin: "0px",
        threshold: 0.2,
      };

      const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const card = entry.target;
            card.classList.add("visible");
            observer.unobserve(card);
          }
        });
      }, observerOptions);

      cards.forEach((card) => {
        observer.observe(card);
      });

      // Audio trimming logic --
      const trimAudioButton = document.getElementById("trimAudioButton");
      const audioInput = document.getElementById("audioInput");
      const trimMenu = document.getElementById("trimMenu");
      const audioPlayer = document.getElementById("audioPlayer");
      const startRange = document.getElementById("startRange");
      const endRange = document.getElementById("endRange");
      const startTimeLabel = document.getElementById("startTimeLabel");
      const endTimeLabel = document.getElementById("endTimeLabel");
      const trimButton = document.getElementById("trimButton");
      const resetButton = document.getElementById("resetButton");
      const trimmedAudioContainer = document.getElementById(
        "trimmedAudioContainer"
      );
      const trimmedAudio = document.getElementById("trimmedAudio");
      const trimmedAudioTitle = document.getElementById("trimmedAudioTitle");
      const downloadButton = document.getElementById("downloadButton");

      let audioBuffer = null;
      let audioContext = null;
      let fileBlobURL = null;
      let trimmedBlob = null;

      trimAudioButton.addEventListener("click", () => {
        // Hide combine menu and show trim menu
        combineMenu.style.display = "none";
        trimMenu.classList.add("visible");
        audioInput.multiple = false;
        audioInput.value = "";
        audioInput.click();
      });

      audioInput.addEventListener("change", async (event) => {
        if (trimMenu.classList.contains("visible")) {
          // Handle trim audio only if trim menu is visible
          const file = event.target.files[0];
          if (!file) {
            return;
          }
          if (fileBlobURL) {
            URL.revokeObjectURL(fileBlobURL);
            fileBlobURL = null;
          }
          if (trimmedBlob) {
            URL.revokeObjectURL(trimmedBlob);
            trimmedBlob = null;
          }
          trimmedAudio.style.display = "none";
          trimmedAudioTitle.style.display = "none";
          downloadButton.style.display = "none";
          downloadButton.disabled = true;
          downloadButton.removeAttribute("data-url");
          trimmedAudio.src = "";

          const fileURL = URL.createObjectURL(file);
          fileBlobURL = fileURL;
          audioPlayer.src = fileURL;
          audioPlayer.load();

          if (!audioContext) {
            audioContext = new (window.AudioContext ||
              window.webkitAudioContext)();
          }
          const arrayBuffer = await file.arrayBuffer();

          try {
            audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
          } catch (error) {
            alert("Error decoding audio file. Please choose a different file.");
            audioBuffer = null;
            return;
          }

          enableTrimControls();
        }
      });

      function enableTrimControls() {
        if (!audioBuffer) return;

        const duration = audioBuffer.duration;

        startRange.min = 0;
        startRange.max = duration;
        startRange.value = 0;
        startRange.step = 0.01;

        endRange.min = 0;
        endRange.max = duration;
        endRange.value = duration;
        endRange.step = 0.01;

        startTimeLabel.textContent = "0.00";
        endTimeLabel.textContent = duration.toFixed(2);

        trimButton.disabled = false;
        trimmedAudio.style.display = "none";
      }

      startRange.addEventListener("input", () => {
        let startVal = parseFloat(startRange.value);
        let endVal = parseFloat(endRange.value);
        if (startVal > endVal - 0.01) {
          startVal = endVal - 0.01;
          startRange.value = startVal;
        }
        startTimeLabel.textContent = startVal.toFixed(2);
      });

      endRange.addEventListener("input", () => {
        let startVal = parseFloat(startRange.value);
        let endVal = parseFloat(endRange.value);
        if (endVal < startVal + 0.01) {
          endVal = startVal + 0.01;
          endRange.value = endVal;
        }
        endTimeLabel.textContent = endVal.toFixed(2);
      });

      trimButton.addEventListener("click", () => {
        if (!audioBuffer) return;
        const startTime = parseFloat(startRange.value);
        const endTime = parseFloat(endRange.value);
        const sampleRate = audioBuffer.sampleRate;
        const startSample = Math.floor(startTime * sampleRate);
        const endSample = Math.floor(endTime * sampleRate);
        const frameCount = endSample - startSample;

        if (frameCount <= 0) {
          alert("End time must be greater than start time.");
          return;
        }

        // Create a new AudioBuffer for trimmed audio
        const numberOfChannels = audioBuffer.numberOfChannels;
        const trimmedBuffer = audioContext.createBuffer(
          numberOfChannels,
          frameCount,
          sampleRate
        );

        // Copy audio data for each channel
        for (let channel = 0; channel < numberOfChannels; channel++) {
          const channelData = audioBuffer
            .getChannelData(channel)
            .slice(startSample, endSample);
          trimmedBuffer.copyToChannel(channelData, channel, 0);
        }

        // Export trimmedBuffer to WAV Blob
        const wavBlob = bufferToWave(trimmedBuffer, frameCount);

        if (trimmedBlob) {
          URL.revokeObjectURL(trimmedBlob);
        }
        trimmedBlob = URL.createObjectURL(wavBlob);

        trimmedAudio.src = trimmedBlob;
        trimmedAudio.style.display = "block";
        trimmedAudioTitle.style.display = "block";
        downloadButton.style.display = "inline-block";
        downloadButton.disabled = false;
        downloadButton.setAttribute("data-url", trimmedBlob);
      });

      resetButton.addEventListener("click", () => {
        audioInput.value = "";
        audioPlayer.src = "";
        trimmedAudio.src = "";
        trimmedAudio.style.display = "none";
        trimmedAudioTitle.style.display = "none";
        downloadButton.style.display = "none";
        downloadButton.disabled = true;
        downloadButton.removeAttribute("data-url");
        if (fileBlobURL) {
          URL.revokeObjectURL(fileBlobURL);
          fileBlobURL = null;
        }
        if (trimmedBlob) {
          URL.revokeObjectURL(trimmedBlob);
          trimmedBlob = null;
        }
        audioBuffer = null;
        trimMenu.classList.remove("visible");
      });

      // Download button triggers a download by creating temporary link
      downloadButton.addEventListener("click", () => {
        const url = downloadButton.getAttribute("data-url");
        if (!url) return;
        const a = document.createElement("a");
        a.style.display = "none";
        a.href = url;
        a.download = "trimmed-audio.wav";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      });

      function bufferToWave(buffer, len) {
        const numChannels = buffer.numberOfChannels;
        const sampleRate = buffer.sampleRate;
        const format = 1; // PCM
        const bitDepth = 16;

        let resultBuffer = new ArrayBuffer(44 + len * numChannels * 2);
        let view = new DataView(resultBuffer);

        /* RIFF identifier */
        writeString(view, 0, "RIFF");
        /* file length */
        view.setUint32(4, 36 + len * numChannels * 2, true);
        /* RIFF type */
        writeString(view, 8, "WAVE");
        /* format chunk identifier */
        writeString(view, 12, "fmt ");
        /* format chunk length */
        view.setUint32(16, 16, true);
        /* sample format (raw) */
        view.setUint16(20, format, true);
        /* channel count */
        view.setUint16(22, numChannels, true);
        /* sample rate */
        view.setUint32(24, sampleRate, true);
        /* byte rate (sample rate * block align) */
        view.setUint32(28, sampleRate * numChannels * (bitDepth / 8), true);
        /* block align (channel count * bytes per sample) */
        view.setUint16(32, numChannels * (bitDepth / 8), true);
        /* bits per sample */
        view.setUint16(34, bitDepth, true);
        /* data chunk identifier */
        writeString(view, 36, "data");
        /* data chunk length */
        view.setUint32(40, len * numChannels * 2, true);

        // Write interleaved PCM samples
        let offset = 44;
        for (let i = 0; i < len; i++) {
          for (let channel = 0; channel < numChannels; channel++) {
            let sample = buffer.getChannelData(channel)[i];
            // Clamping
            if (sample > 1) sample = 1;
            else if (sample < -1) sample = -1;
            // Scale to 16-bit signed integer
            sample = sample < 0 ? sample * 0x8000 : sample * 0x7fff;
            view.setInt16(offset, sample, true);
            offset += 2;
          }
        }

        return new Blob([view], { type: "audio/wav" });
      }

      function writeString(view, offset, string) {
        for (let i = 0; i < string.length; i++) {
          view.setUint8(offset + i, string.charCodeAt(i));
        }
      }

      // Combine Audio Logic
      const combineAudioButton = document.getElementById("combineAudioButton");
      const combineMenu = document.getElementById("combineMenu");
      const addAudioButton = document.getElementById("addAudioButton");
      const audioList = document.getElementById("audioList");
      const combineButton = document.getElementById("combineButton");
      const combinedAudio = document.getElementById("combinedAudio");
      const downloadCombinedButton = document.getElementById(
        "downloadCombinedButton"
      );

      let combineAudioFiles = [];

      combineAudioButton.addEventListener("click", () => {
        // Hide trim menu & reset
        trimMenu.classList.remove("visible");
        trimmedAudio.style.display = "none";
        trimmedAudioTitle.style.display = "none";
        downloadButton.style.display = "none";
        downloadButton.disabled = true;
        downloadButton.removeAttribute("data-url");
        trimmedAudio.src = "";
        audioInput.value = "";

        combineMenu.style.display = "block";
        audioList.innerHTML = ""; // Clear previous list
        combineAudioFiles = [];
        combineButton.disabled = true;
        combinedAudio.style.display = "none";
        combinedAudio.src = "";
        downloadCombinedButton.style.display = "none";
        downloadCombinedButton.disabled = true;
      });

      addAudioButton.addEventListener("click", () => {
        const tempInput = document.createElement("input");
        tempInput.type = "file";
        tempInput.accept = "audio/*";
        tempInput.multiple = true;
        tempInput.addEventListener("change", (event) => {
          const files = Array.from(event.target.files);

          files.forEach((file) => {
            // Add file to the list
            combineAudioFiles.push(file);

            // Create list item element
            const listItem = document.createElement("div");
            listItem.className = "audioItem";
            listItem.setAttribute("draggable", "true");
            listItem.setAttribute("tabindex", "0");

            // Create text span for file name
            const fileNameSpan = document.createElement("span");
            fileNameSpan.textContent = file.name;
            listItem.appendChild(fileNameSpan);

            // Remove button
            const removeBtn = document.createElement("button");
            removeBtn.className = "removeBtn";
            removeBtn.type = "button";
            removeBtn.setAttribute("aria-label", "Remove " + file.name);
            removeBtn.textContent = "Remove";
            removeBtn.addEventListener("click", () => {
              // Remove from array and DOM
              combineAudioFiles = combineAudioFiles.filter((f) => f !== file);
              listItem.remove();
              updateCombineButtonState();
            });
            listItem.appendChild(removeBtn);

            audioList.appendChild(listItem);

            // Drag and Drop Handlers for reorder
            listItem.addEventListener("dragstart", (e) => {
              e.dataTransfer.setData("text/plain", null);
              draggedItem = listItem;
              listItem.classList.add("dragging");
            });
            listItem.addEventListener("dragend", () => {
              draggedItem.classList.remove("dragging");
              draggedItem = null;
            });

            listItem.addEventListener("dragover", (e) => {
              e.preventDefault();
              const bounding = listItem.getBoundingClientRect();
              const offset = bounding.y + bounding.height / 2;
              const parent = listItem.parentNode;
              if (e.clientY - offset > 0) {
                if (listItem.nextSibling !== draggedItem) {
                  parent.insertBefore(draggedItem, listItem.nextSibling);
                  reorderFilesInArray();
                }
              } else {
                if (listItem.previousSibling !== draggedItem) {
                  parent.insertBefore(draggedItem, listItem);
                  reorderFilesInArray();
                }
              }
            });
          });

          updateCombineButtonState();
        });
        tempInput.click();
      });

      // Track dragged item for drag and drop
      let draggedItem = null;

      function reorderFilesInArray() {
        // Rebuild combineAudioFiles array according to DOM order
        const currentOrder = [];
        const children = audioList.children;
        for (let i = 0; i < children.length; i++) {
          const name = children[i].querySelector("span").textContent;
          const file = combineAudioFiles.find((f) => f.name === name);
          if (file) currentOrder.push(file);
        }
        combineAudioFiles = currentOrder;
      }

      function updateCombineButtonState() {
        combineButton.disabled = combineAudioFiles.length === 0;
      }

      combineButton.addEventListener("click", async () => {
        if (!combineAudioFiles.length) return;

        if (!audioContext) {
          audioContext = new (window.AudioContext ||
            window.webkitAudioContext)();
        }

        try {
          const buffers = [];
          for (const file of combineAudioFiles) {
            const arrayBuffer = await file.arrayBuffer();
            const buffer = await audioContext.decodeAudioData(arrayBuffer);
            buffers.push(buffer);
          }

          // Calculate total length in samples
          const totalLength = buffers.reduce((acc, b) => acc + b.length, 0);

          // Use number of channels and sampleRate of first buffer
          const numberOfChannels = Math.max(
            ...buffers.map((b) => b.numberOfChannels)
          );
          const sampleRate = buffers[0].sampleRate;

          // Create combined buffer
          const combinedBuffer = audioContext.createBuffer(
            numberOfChannels,
            totalLength,
            sampleRate
          );

          // Copy data channel-wise, padding channels if needed
          let offset = 0;
          for (const buffer of buffers) {
            for (let channel = 0; channel < numberOfChannels; channel++) {
              const channelData = combinedBuffer.getChannelData(channel);
              // copy if buffer has this channel, else fill with 0s
              if (channel < buffer.numberOfChannels) {
                channelData.set(buffer.getChannelData(channel), offset);
              } else {
                // Fill with silence if missing channel
                channelData.fill(0, offset, offset + buffer.length);
              }
            }
            offset += buffer.length;
          }

          const wavBlob = bufferToWave(combinedBuffer, totalLength);

          // Revoke previous URLs if any
          if (combinedAudio.src) {
            URL.revokeObjectURL(combinedAudio.src);
          }
          const combinedUrl = URL.createObjectURL(wavBlob);
          combinedAudio.src = combinedUrl;
          combinedAudio.style.display = "block";
          downloadCombinedButton.style.display = "inline-block";
          downloadCombinedButton.disabled = false;
        } catch (error) {
          alert("Error combining audio files. Please try different files.");
          console.error(error);
        }
      });

      downloadCombinedButton.addEventListener("click", () => {
        const url = combinedAudio.src;
        if (!url) return;
        const a = document.createElement("a");
        a.style.display = "none";
        a.href = url;
        a.download = "combined-audio.wav";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      });

      // Global page loader fade out
      window.addEventListener("load", () => {
        const loader = document.getElementById("loader-overlay");
        loader.classList.add("fade-out");
        setTimeout(() => loader.remove(), 700);
      });

      // Stagger animation for panel children
      window.addEventListener("DOMContentLoaded", () => {
        const panelChildren = document.querySelector(".panel")?.children || [];
        Array.from(panelChildren).forEach((child, i) => {
          child.style.opacity = "0";
          child.style.transform = "translateY(15px)";
          child.style.transition = `opacity 0.6s ease ${
            i * 0.1
          }s, transform 0.6s ease ${i * 0.1}s`;
          setTimeout(() => {
            child.style.opacity = "1";
            child.style.transform = "translateY(0)";
          }, 200);
        });
      });
    </script>
  </body>
</html>
